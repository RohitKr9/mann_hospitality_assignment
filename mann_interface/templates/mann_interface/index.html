{% extends "base.html" %}

{% block styles %}
    #table{
        height: 75vh;
        border: solid;
    }
{% endblock styles %}


{% block content %}
    <form id="upload_form" action="/file_upload" method="post" enctype="multipart/form-data">
        <label for="myfile">Select a file:</label>
        <input type="file" id="myfile" name="myfile">
        <button type="submit">upload</button>
    </form>
    <button type="button" id="show_table">Show Table</button>
    <div id="table">

    </div>

    <script>
        let myfile 

        const form = document.getElementById("upload_form")
        const table = document.getElementById("table")
        const button_show_table = document.getElementById("show_table")
        form.addEventListener('submit', uploadFile)
        button_show_table.addEventListener('click', showFile)

        async function uploadFile(event) {
            event.preventDefault()
            const file_as_form = new FormData(form)

            fetch(form.action, {
                method: form.method,
                body: file_as_form
            })
            .then(response => response)
            .then(data => {
                console.log(data)
                myfile = data
            })
        }

        function showFile(event){
            table.innerHTML = myfile
            console.log(myfile)
        }
    </script>
{% endblock content %}